var t;
/** @license Kaiku
 * kaiku.ts
 *
 * Copyright (c) 2021 Teemu Pääkkönen
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */const n=Symbol(),e=Symbol(),o=Symbol(),r=Symbol();class c{constructor(t){this.props={},this.state=void 0,this.props=t}componentDidMount(){}componentWillUnmount(){}}c[t=n]=1;const s={};function l(t,n){if(!t)throw Error(n??"assert")}const i=(t,n)=>{const e=Object.keys(t),o=Object.keys(n);for(const n of o)n in t||e.push(n);return e},a=void 0;let u=0;const f=t=>{switch(t.t){case 1:case 0:J(t);break;case 5:D(t);break;case 6:Z(t)}};let p=0,_=0;const d=[],g=new Map,y=new Map,b=new Map;let w=[];const m={};let h=0;const v=()=>{h=0;const t=new Set,n=[...w];w=[];for(const e of n){const n=b.get(e);if(n)for(const e of n){if(t.has(e))continue;t.add(e);const n=g.get(e);n&&f(n)}}0!==w.length&&(h=1,v())},S=(t,n,...e)=>{g.set(t.o,t);const o=y.get(t.o);if(o)for(const n of o){const e=b.get(n);e.delete(t.o),0===e.size&&b.delete(n)}d.push(new Set);const r=n(...e),c=d.pop();y.set(t.o,c);for(const n of c){let e=b.get(n);e||(e=new Set,b.set(n,e)),e.add(t.o)}return r},x=t=>{g.delete(t.o),y.delete(t.o)},k=t=>{const n=++p,c=Array.isArray(t);let s=1;const l=new Proxy(t,{get(t,e){if(e===r)return t;if(e===o)return 1;if("symbol"==typeof e)return t[e];if(d.length){const t=n+(m[e]||(m[e]=67108864*++_));d[d.length-1].add(t)}const s=t[e];return c||"function"!=typeof s?s:s.bind(t)},deleteProperty(t,e){const o=e;return s||(w.push(n),h||(h=1,window.queueMicrotask(v))),delete t[o]},ownKeys:t=>(d.length&&d[d.length-1].add(n),Reflect.ownKeys(t)),set(t,r,l){const i=r,a=!(i in t);if((!c||"length"!==i)&&(null===l||"object"!=typeof l||l[o])&&t[i]===l)return 1;if("symbol"==typeof i)return t[i]=l,1;if(null===l||"object"!=typeof l||l[o]||l[e]?t[i]=l:t[i]=k(l),s)return 1;a&&w.push(n);const u=n+(m[i]||(m[i]=67108864*++_));return w.push(u),h||(h=1,window.queueMicrotask(v)),1}}),i=Object.keys(t);for(const t of i)"object"==typeof l[t]&&(l[t]=l[t]);return s=0,l},M=t=>t[r],j=t=>new Proxy(t,{get:(t,n)=>n===e?1:t[n]}),E=new Map,N=new Map,A=[],O=[],P=new Set,U=t=>{O.push(t),A.push(0)},z=()=>{A.pop();const t=O.pop();P.add(t)},V=t=>{P.delete(t),N.delete(t);const n=E.get(t);if(n)for(const t of n)t.l?.();E.delete(t)},D=t=>{t.l?.(),t.l=S(t,t.i)},K=t=>{const n=O[O.length-1];if(void 0!==n&&P.has(n))return;const e={o:++u,t:5,i:t};if(D(e),!n)return;let o=E.get(n);o||(o=[],E.set(n,o)),o.push(e)},R=t=>{const n=O[O.length-1],e=A[A.length-1]++;let o=N.get(n);if(o||(o=[],N.set(n,o)),o.length>e)return o[e];const r=k(t);return o.push(r),r},W=t=>R({current:t}),q=t=>{const n=[];for(const e of t)null!=e&&"boolean"!=typeof e?"string"!=typeof e&&"number"!=typeof e?Array.isArray(e)?n.push(Q(s,e)):"function"!=typeof e?n.push(e):n.push(at(e,s)):n.push({t:4,u:e}):n.push({t:4,u:""});return n},B=(t,n)=>0===t.t&&0===n.t&&t.p instanceof n._||1===t.t&&1===n.t&&t.g===n.g?(J(t,n.props),1):2===t.t&&2===n.t&&t.m===n.m?(rt(t,n.props,n.v),1):3===t.t&&3===n.t?(X(t,n.v),1):4===t.t&&4===n.t?(t.S.data!==n.u+""&&(t.S.data=n.u),1):0,C=t=>4===t.t?null:void 0!==t.props?.key?t.props?.key:null,F=(t,n)=>({t:0,_:t,props:n}),G=(t,n)=>{const e=++u;U(e);const o=new t._(t.props);z(),o.render=o.render.bind(o),void 0!==o.state&&(o.state=k(o.state));const r={o:e,t:0,k:n,p:o,props:t.props,M:null,j:null,N:null};return J(r),r},H=(t,n)=>({t:1,g:t,props:n}),I=(t,n)=>{const e={o:++u,t:1,k:n,g:t.g,props:t.props,M:null,j:null,N:null};return J(e),e},J=(t,n=t.props)=>{if(n!==t.props){const e=i(n,t.props);let o=1;for(const r of e)if(n[r]!==t.props[r]){o=0;break}if(o)return}let e;if(t.props=n,1===t.t?(U(t.o),e=S(t,t.g,t.props),z()):(t.p.props=n,e=S(t,t.p.render,n)),!e)return t.N&&it(t.N),void(t.N=null);if(t.N){if(!B(t.N,e)){it(t.N);const n=ct(e,t.k);t.N=n}}else t.N=ct(e,t.k);t.M&&lt(t,t.M,t.j)},L=Symbol(),Q=(t,n)=>({t:3,v:n,props:t}),T=(t,n)=>{const e={t:3,props:t.props,k:n,M:null,j:null,A:new Map,v:[]};return X(e,t.v),e},X=(t,n)=>{const e=q(n);t.v=[];const o=new Set;for(let n=e.length-1;n>=0;n--){const r=e[n],c=C(r),s=null===c?n:c;o.add(s);const l=t.A.get(s);if(l&&B(l,r))t.v.push(l);else{l&&it(l);const n=ct(r,t.k);t.v.push(n),t.A.set(s,n)}}for(const[n,e]of t.A)o.has(n)||(it(e),t.A.delete(n))},Y=t=>({t:4,S:document.createTextNode(t.u),M:null,j:null}),Z=t=>{const{O:n,P:e,U:o}=t,r=S(t,n);r!==o&&(t.U=r,e(r))},$=(t,n,e)=>{if("function"!=typeof n)return void e(n);const o={o:++u,t:6,U:void 0,O:n,P:e};Z(o),t.V.push(o)},tt=t=>{for(let n;n=t.V.pop();)x(n)},nt=t=>{if("string"==typeof t)return t;let n="";if(Array.isArray(t)){for(const e of t)n+=nt(e)+" ";return n.trim()}const e=Object.keys(t);for(const o of e)t[o]&&(n+=o+" ");return n.trim()},et=(t,n,e)=>({t:2,m:t,props:n,v:e}),ot=(t,n)=>{const e="svg"===t.m||n.D;n.D!==e&&(n={D:e});const o=t.K||(e?document.createElementNS("http://www.w3.org/2000/svg",t.m):document.createElement(t.m)),r={t:2,m:t.m,k:n,S:o,M:null,j:null,props:s,v:null,V:[]};return rt(r,t.props,t.v),r},rt=(t,n,e)=>{const o=i(n,t.props);for(const e of o)if(t.props[e]!==n[e]&&"key"!==e)if("ref"!==e)if("o"===e[0]&&"n"===e[1]){const o=e.substr(2).toLowerCase();e in t.props&&t.S.removeEventListener(o,t.props[e]),e in n&&t.S.addEventListener(o,n[e])}else{switch(e){case"style":{const e=i(n.style||s,t.props.style||s);for(const o of e)n.style?.[o]!==t.props.style?.[o]&&$(t,n.style?.[o]??"",(n=>{t.S.style[o]=n}));continue}case"value":$(t,n[e]??"",(n=>{t.S.value=n}));continue;case"checked":$(t,n[e]??"",(n=>{t.S.checked=!!n}));continue;case"className":$(t,n[e],(n=>{t.S.className=nt(n??"")}));continue}e in n?$(t,n[e],(n=>{void 0===n||0==n||null===n?t.S.removeAttribute(e):t.S.setAttribute(e,n)})):t.S.removeAttribute(e)}else n[e].current=t.S;t.props=n,0===e.length?(t.v&&it(t.v),t.v=null):t.v?B(t.v,Q(s,e)):t.v=T(Q(s,e),t.k)},ct=(t,n)=>{switch(t.t){case 0:return G(t,n);case 1:return I(t,n);case 2:return ot(t,n);case 3:return T(t,n);case 4:return Y(t)}},st=t=>{switch(t.t){case 0:case 1:return t.N?st(t.N):t.j?st(t.j):null;case 3:return 0!==t.v.length?st(t.v[t.v.length-1]):t.j?st(t.j):null;case 4:case 2:return t.S}},lt=(t,n,e)=>{switch(t.t){case 0:case 1:t.N&&lt(t.N,n,e),0!==t.t||t.M||t.p.componentDidMount(),t.M=n,t.j=e;break;case 4:case 2:{if(2===t.t&&t.v&&lt(t.v,t,null),t.M===n&&t.j===e)break;t.j=e,t.M=n;const o=e&&st(e);n.S.insertBefore(t.S,o);break}case 3:t.j=e;for(const o of t.v)lt(o,n,e),e=o}},it=t=>{switch(t.t){case 1:V(t.o),x(t),t.N&&it(t.N);break;case 0:V(t.o),t.p.componentWillUnmount(),x(t),t.N&&it(t.N);break;case 2:tt(t),t.M.S.removeChild(t.S),t.v&&t.v.v.forEach(it);break;case 4:t.M.S.removeChild(t.S);break;case 3:t.v.forEach(it)}};function at(t,e,...o){return"string"==typeof t?et(t,e||s,o):t[n]?F(t,{...e||s,children:0===o.length?void 0:o}):t===L?Q(e||s,o):H(t,{...e||s,children:0===o.length?void 0:o})}function ut(t,e,o){let r=e?.children;r=void 0!==r?Array.isArray(r)?r:[r]:void 0;const c={...e,children:r,key:o};return"string"==typeof t?(delete c.children,et(t,c,r??[])):t[n]?F(t,c):t===L?(delete c.children,Q(c,r??[])):H(t,c)}const ft=(t,n)=>{const e={t:2,m:n.tagName,S:n,v:null,k:{D:0},M:null,j:null,props:s,V:[]},o=ct(t,{D:0});lt(o,e,null)};export{c as Component,L as Fragment,at as h,ut as jsx,ft as render,R as useState,W as useRef,K as useEffect,k as createState,j as immutable,M as unwrap};
//# sourceMappingURL=kaiku.min.js.map